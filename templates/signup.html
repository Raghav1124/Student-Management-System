<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sign Up - Student Management System</title>

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Bootstrap Icons -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css"
      rel="stylesheet"
    />
    <!-- Custom CSS -->
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/style.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/transitions.css') }}"
    />

    <style>
      body {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        display: flex;
        align-items: center;
        padding: 20px;
      }

      .signup-container {
        max-width: 450px;
        margin: 0 auto;
        animation: slideInLeft 0.6s ease-out;
      }

      .signup-card {
        border-radius: 20px;
        border: none;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        overflow: hidden;
      }

      .signup-header {
        background: linear-gradient(135deg, #4cc9f0, #4895ef);
        padding: 40px 20px;
        text-align: center;
        color: white;
      }

      .signup-body {
        padding: 40px;
        background: white;
      }

      .form-control {
        padding: 12px 15px;
        border-radius: 10px;
        border: 2px solid #e0e0e0;
        transition: all 0.3s ease;
      }

      .form-control:focus {
        border-color: #4cc9f0;
        box-shadow: 0 0 0 0.25rem rgba(76, 201, 240, 0.25);
      }

      .btn-signup {
        background: linear-gradient(135deg, #4cc9f0, #4895ef);
        border: none;
        padding: 12px;
        border-radius: 10px;
        font-weight: 600;
        transition: all 0.3s ease;
      }

      .btn-signup:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 20px rgba(76, 201, 240, 0.3);
      }

      .signup-footer {
        text-align: center;
        padding: 20px;
        background: #f8f9fa;
        border-top: 1px solid #e0e0e0;
      }

      .brand-logo {
        font-size: 2.5rem;
        margin-bottom: 10px;
      }

      .password-strength {
        height: 4px;
        background: #e0e0e0;
        border-radius: 2px;
        margin-top: 5px;
        overflow: hidden;
      }

      .strength-meter {
        height: 100%;
        width: 0%;
        transition: width 0.3s ease;
      }

      .strength-weak {
        background: #f72585;
        width: 33%;
      }
      .strength-medium {
        background: #f8961e;
        width: 66%;
      }
      .strength-strong {
        background: #4cc9f0;
        width: 100%;
      }

      .requirement-list {
        font-size: 0.85rem;
        margin-top: 10px;
      }

      .requirement-list li {
        margin-bottom: 5px;
        color: #666;
      }

      .requirement-list .valid {
        color: #4cc9f0;
      }

      .requirement-list .invalid {
        color: #f72585;
      }
    </style>
  </head>
  <body>
    <div class="signup-container">
      <div class="signup-card">
        <div class="signup-header">
          <div class="brand-logo">
            <i class="bi bi-mortarboard-fill"></i>
          </div>
          <h2 class="mb-2">Create Account</h2>
          <p class="mb-0 opacity-75">Join our student management system</p>
        </div>

        <div class="signup-body">
          {% with messages = get_flashed_messages(with_categories=true) %} {% if
          messages %} {% for category, message in messages %}
          <div
            class="alert alert-{{ category }} alert-dismissible fade show mb-4"
            role="alert"
          >
            {{ message }}
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="alert"
            ></button>
          </div>
          {% endfor %} {% endif %} {% endwith %}

          <form method="POST" action="/signup" id="signupForm">
            <div class="mb-4">
              <label for="username" class="form-label fw-semibold">
                <i class="bi bi-person-badge me-2"></i>Username
              </label>
              <input
                type="text"
                class="form-control"
                id="username"
                name="username"
                placeholder="Choose a username"
                required
                autofocus
              />
              <div class="form-text">
                Use 3-20 characters, letters and numbers only
              </div>
            </div>

            <div class="mb-4">
              <label for="password" class="form-label fw-semibold">
                <i class="bi bi-lock-fill me-2"></i>Password
              </label>
              <input
                type="password"
                class="form-control"
                id="password"
                name="password"
                placeholder="Create a strong password"
                required
              />
              <div class="password-strength">
                <div class="strength-meter" id="strengthMeter"></div>
              </div>
              <ul class="requirement-list list-unstyled">
                <li id="reqLength">
                  <i class="bi bi-x-circle invalid"></i> At least 6 characters
                </li>
                <li id="reqUppercase">
                  <i class="bi bi-x-circle invalid"></i> One uppercase letter
                </li>
                <li id="reqNumber">
                  <i class="bi bi-x-circle invalid"></i> One number
                </li>
              </ul>
            </div>

            <div class="mb-4">
              <label for="confirm_password" class="form-label fw-semibold">
                <i class="bi bi-lock-fill me-2"></i>Confirm Password
              </label>
              <input
                type="password"
                class="form-control"
                id="confirm_password"
                name="confirm_password"
                placeholder="Confirm your password"
                required
              />
              <div class="form-text" id="passwordMatch"></div>
            </div>

            <div class="mb-4 form-check">
              <input
                type="checkbox"
                class="form-check-input"
                id="terms"
                required
              />
              <label class="form-check-label" for="terms">
                I agree to the
                <a href="#" class="text-decoration-none">Terms of Service</a>
                and
                <a href="#" class="text-decoration-none">Privacy Policy</a>
              </label>
            </div>

            <button type="submit" class="btn btn-signup w-100">
              <i class="bi bi-person-plus me-2"></i>Create Account
            </button>
          </form>
        </div>

        <div class="signup-footer">
          <p class="mb-0">
            Already have an account?
            <a href="/" class="text-decoration-none fw-semibold">Sign in</a>
          </p>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/transitions.js') }}"></script>

    <script>
      // Password strength checker
      const passwordInput = document.getElementById("password");
      const confirmPasswordInput = document.getElementById("confirm_password");
      const strengthMeter = document.getElementById("strengthMeter");
      const passwordMatch = document.getElementById("passwordMatch");

      const requirements = {
        length: document.getElementById("reqLength"),
        uppercase: document.getElementById("reqUppercase"),
        number: document.getElementById("reqNumber"),
      };

      passwordInput.addEventListener("input", function () {
        const password = this.value;
        let strength = 0;

        // Check requirements
        const hasLength = password.length >= 6;
        const hasUppercase = /[A-Z]/.test(password);
        const hasNumber = /\d/.test(password);

        // Update requirement indicators
        updateRequirement(requirements.length, hasLength);
        updateRequirement(requirements.uppercase, hasUppercase);
        updateRequirement(requirements.number, hasNumber);

        // Calculate strength
        if (hasLength) strength++;
        if (hasUppercase) strength++;
        if (hasNumber) strength++;

        // Update strength meter
        updateStrengthMeter(strength);
      });

      confirmPasswordInput.addEventListener("input", function () {
        const password = passwordInput.value;
        const confirm = this.value;

        if (confirm === "") {
          passwordMatch.textContent = "";
          passwordMatch.className = "form-text";
        } else if (password === confirm) {
          passwordMatch.textContent = "✓ Passwords match";
          passwordMatch.className = "form-text text-success";
        } else {
          passwordMatch.textContent = "✗ Passwords do not match";
          passwordMatch.className = "form-text text-danger";
        }
      });

      function updateRequirement(element, isValid) {
        const icon = element.querySelector("i");
        if (isValid) {
          icon.className = "bi bi-check-circle valid";
        } else {
          icon.className = "bi bi-x-circle invalid";
        }
      }

      function updateStrengthMeter(strength) {
        strengthMeter.className = "strength-meter";

        switch (strength) {
          case 0:
            strengthMeter.className = "strength-meter";
            break;
          case 1:
            strengthMeter.className = "strength-meter strength-weak";
            break;
          case 2:
            strengthMeter.className = "strength-meter strength-medium";
            break;
          case 3:
            strengthMeter.className = "strength-meter strength-strong";
            break;
        }
      }

      // Form submission
      document
        .getElementById("signupForm")
        .addEventListener("submit", function (e) {
          const password = passwordInput.value;
          const confirm = confirmPasswordInput.value;

          if (password !== confirm) {
            e.preventDefault();
            passwordMatch.textContent = "✗ Passwords do not match";
            passwordMatch.className = "form-text text-danger";
            confirmPasswordInput.focus();
            return;
          }

          if (password.length < 6) {
            e.preventDefault();
            passwordInput.focus();
            return;
          }

          // Show loading state
          const submitBtn = this.querySelector('button[type="submit"]');
          const originalText = submitBtn.innerHTML;

          submitBtn.innerHTML =
            '<span class="spinner-border spinner-border-sm me-2"></span>Creating account...';
          submitBtn.disabled = true;

          // Re-enable button after 3 seconds if form hasn't submitted
          setTimeout(() => {
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
          }, 3000);
        });

      // Add animation to form elements
      document.addEventListener("DOMContentLoaded", function () {
        const inputs = document.querySelectorAll(".form-control");
        inputs.forEach((input, index) => {
          input.style.animationDelay = `${index * 0.1}s`;
          input.classList.add("fade-in");
        });
      });
    </script>
  </body>
</html>
